<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Support for various single cell object formats â€¢ clustifyR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Support for various single cell object formats">
<meta property="og:description" content="">
<meta property="og:image" content="http://rnabioco.github.io/clustifyR/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">clustifyR</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/clustifyR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmark.html">Benchmarking clustifyR</a>
    </li>
    <li>
      <a href="../articles/otherformats.html">Support for various single cell object formats</a>
    </li>
    <li>
      <a href="../articles/othertools.html">Other considerations w/ clustifyR</a>
    </li>
    <li>
      <a href="../articles/references.html">Reference building for clustifyR</a>
    </li>
    <li>
      <a href="../articles/visualizations.html">Visualization of clustifyR results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rnabioco/clustifyR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Support for various single cell object formats</h1>
            
            <h4 class="date">2019-05-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rnabioco/clustifyR/blob/master/vignettes/otherformats.Rmd"><code>vignettes/otherformats.Rmd</code></a></small>
      <div class="hidden name"><code>otherformats.Rmd</code></div>

    </div>

    
    
<p><code>clustifyR</code> is aimed for general use and flexibility in various analysis pipelines. While its core code functions with matrices and dataframes, and hence has minimal package dependencies, wrapper functions are provided for further convenience of the user.</p>
<div id="direct-handling-of-seurat-objects-v2-and-v3-extracting-the-required-data-and-inserting-called-cell-types-directly-into-the-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#direct-handling-of-seurat-objects-v2-and-v3-extracting-the-required-data-and-inserting-called-cell-types-directly-into-the-objects" class="anchor"></a>Direct handling of <code>seurat</code> objects, v2 and v3, extracting the required data, and inserting called cell types directly into the objects</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(clustifyR)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># can even returning a new object with `type` added to metadata.</span></a>
<a class="sourceLine" id="cb1-3" title="3">res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clustify.html">clustify</a></span>(</a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="dt">input =</span> s_small,</a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="dt">cluster_col =</span> <span class="st">"res.1"</span>,</a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="dt">ref_mat =</span> pbmc_bulk_matrix,</a>
<a class="sourceLine" id="cb1-7" title="7">  <span class="dt">seurat_out =</span> T</a>
<a class="sourceLine" id="cb1-8" title="8">)</a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co"># or return a correlation matrix, if seurat_out is set to F</span></a>
<a class="sourceLine" id="cb1-11" title="11">res2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clustify_lists.html">clustify_lists</a></span>(</a>
<a class="sourceLine" id="cb1-12" title="12">  s_small,</a>
<a class="sourceLine" id="cb1-13" title="13">  <span class="dt">per_cell =</span> F,</a>
<a class="sourceLine" id="cb1-14" title="14">  <span class="dt">marker =</span> pbmc4k_markers,</a>
<a class="sourceLine" id="cb1-15" title="15">  <span class="dt">marker_inmatrix =</span> F,</a>
<a class="sourceLine" id="cb1-16" title="16">  <span class="dt">cluster_col =</span> <span class="st">"res.1"</span>,</a>
<a class="sourceLine" id="cb1-17" title="17">  <span class="dt">seurat_out =</span> F</a>
<a class="sourceLine" id="cb1-18" title="18">)</a>
<a class="sourceLine" id="cb1-19" title="19"></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co"># and combined ref matrix and marker info</span></a>
<a class="sourceLine" id="cb1-21" title="21">res3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clustify_nudge.html">clustify_nudge</a></span>(</a>
<a class="sourceLine" id="cb1-22" title="22">  <span class="dt">input =</span> s_small3,</a>
<a class="sourceLine" id="cb1-23" title="23">  <span class="dt">ref_mat =</span> cbmc_ref,</a>
<a class="sourceLine" id="cb1-24" title="24">  <span class="dt">marker =</span> cbmc_m,</a>
<a class="sourceLine" id="cb1-25" title="25">  <span class="dt">cluster_col =</span> <span class="st">"RNA_snn_res.1"</span>,</a>
<a class="sourceLine" id="cb1-26" title="26">  <span class="dt">seurat_out =</span> F</a>
<a class="sourceLine" id="cb1-27" title="27">)</a></code></pre></div>
</div>
<div id="other-scrna-seq-object-formats-are-easily-supported-by-adding-defaults-to-a-lookup-file-object_loc_lookup-currently-including-sce-urd-cds-fsce-" class="section level2">
<h2 class="hasAnchor">
<a href="#other-scrna-seq-object-formats-are-easily-supported-by-adding-defaults-to-a-lookup-file-object_loc_lookup-currently-including-sce-urd-cds-fsce-" class="anchor"></a>Other scRNA-seq object formats are easily supported, by adding defaults to a lookup file <code>object_loc_lookup</code>, currently including <code>SCE</code>, <code>URD</code>, <code>CDS</code>, <code>FSCE</code>.</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># location of data in object in this format</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(clustifyR)</a>
<a class="sourceLine" id="cb2-3" title="3">object_loc_lookup</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt;              SingleCellExperiment               URD</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; expr  input@assays$data$logcounts input@logupx.data</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; meta as.data.frame(input@colData)        input@meta</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; var                          NULL   input@var.genes</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; col                    cell_type1           cluster</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt;                         FunctionalSingleCellExperiment</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; expr input@ExperimentList$rnaseq@assays$data$logcounts</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; meta               input@ExperimentList$rnaseq@colData</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; var                                               NULL</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; col                                     leiden_cluster</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt;                             Seurat</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; expr         input@assays$RNA@data</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt; meta               input@meta.data</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">#&gt; var  input@assays$RNA@var.features</span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">#&gt; col                  RNA_snn_res.1</span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="co">#&gt;                                                                                                                CellDataSet</span></a>
<a class="sourceLine" id="cb2-20" title="20"><span class="co">#&gt; expr do.call(function(x) {row.names(x) &lt;- input@featureData@data$gene_short_name; return(x)}, list(input@assayData$exprs))</span></a>
<a class="sourceLine" id="cb2-21" title="21"><span class="co">#&gt; meta                                                                                   as.data.frame(input@phenoData@data)</span></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="co">#&gt; var                     as.character(input@featureData@data$gene_short_name[input@featureData@data$use_for_ordering == T])</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="co">#&gt; col                                                                                                           Main_Cluster</span></a>
<a class="sourceLine" id="cb2-24" title="24"></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="co"># adding seurat3 locations</span></a>
<a class="sourceLine" id="cb2-26" title="26">object_loc_lookup<span class="op">$</span>Seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">expr =</span> <span class="st">"input@assays$RNA@data"</span>, </a>
<a class="sourceLine" id="cb2-27" title="27">                              <span class="dt">meta =</span> <span class="st">"input@meta.data"</span>, </a>
<a class="sourceLine" id="cb2-28" title="28">                              <span class="dt">var =</span> <span class="st">"input@assays$RNA@var.features"</span>,</a>
<a class="sourceLine" id="cb2-29" title="29">                              <span class="dt">col =</span> <span class="st">"RNA_snn_res.1"</span></a>
<a class="sourceLine" id="cb2-30" title="30">                              )</a></code></pre></div>
<p>For example, sample code for <code>scrunchy</code> is as easy as:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clustify_nudge.html">clustify_nudge</a></span>(</a>
<a class="sourceLine" id="cb3-2" title="2">  fsce_small,</a>
<a class="sourceLine" id="cb3-3" title="3">  cbmc_ref,</a>
<a class="sourceLine" id="cb3-4" title="4">  cbmc_m,</a>
<a class="sourceLine" id="cb3-5" title="5">  <span class="dt">query_genes =</span> pbmc4k_vargenes,</a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="dt">cluster_col =</span> <span class="st">"k_cluster"</span></a>
<a class="sourceLine" id="cb3-7" title="7">)</a></code></pre></div>
</div>
<div id="making-new-references-from-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#making-new-references-from-objects" class="anchor"></a>Making new references from objects</h2>
<p>Making scRNA-seq objects into references is assisted by wrappers as well.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># for both v2 and v3</span></a>
<a class="sourceLine" id="cb4-2" title="2">seurat_ref &lt;-<span class="st"> </span><span class="kw"><a href="../reference/use_seurat_comp.html">use_seurat_comp</a></span>(</a>
<a class="sourceLine" id="cb4-3" title="3">  s_small3,</a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="dt">cluster_col =</span> <span class="st">"RNA_snn_res.1"</span></a>
<a class="sourceLine" id="cb4-5" title="5">)</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co"># and other object types with lookup</span></a>
<a class="sourceLine" id="cb4-8" title="8">object_ref &lt;-<span class="st"> </span><span class="kw"><a href="../reference/use_object_comp.html">use_object_comp</a></span>(<span class="dt">input =</span> input)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#direct-handling-of-seurat-objects-v2-and-v3-extracting-the-required-data-and-inserting-called-cell-types-directly-into-the-objects">Direct handling of <code>seurat</code> objects, v2 and v3, extracting the required data, and inserting called cell types directly into the objects</a></li>
      <li><a href="#other-scrna-seq-object-formats-are-easily-supported-by-adding-defaults-to-a-lookup-file-object_loc_lookup-currently-including-sce-urd-cds-fsce-">Other scRNA-seq object formats are easily supported, by adding defaults to a lookup file <code>object_loc_lookup</code>, currently including <code>SCE</code>, <code>URD</code>, <code>CDS</code>, <code>FSCE</code>.</a></li>
      <li><a href="#making-new-references-from-objects">Making new references from objects</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Rui Fu, Kent Riemondy, Austin Gillen, Chengzhe Tian, Jay Hesselberth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
