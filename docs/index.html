<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Classifier for Single-cell RNA-seq Using Cell Clusters â€¢ clustifyr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Classifier for Single-cell RNA-seq Using Cell Clusters">
<meta property="og:description" content="Classify cells from single-cell RNA sequencing data
    using external reference data (e.g., bulk RNA-seq).">
<meta property="og:image" content="http://rnabioco.github.io/clustifyr/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">clustifyr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/benchmark.html">Benchmarking clustifyr</a>
    </li>
    <li>
      <a href="articles/clustifyR.html">Introduction to clustifyr</a>
    </li>
    <li>
      <a href="articles/otherformats.html">Support for various single cell object formats</a>
    </li>
    <li>
      <a href="articles/othertools.html">Other considerations w/ clustifyr</a>
    </li>
    <li>
      <a href="articles/references.html">Reference building for clustifyr</a>
    </li>
    <li>
      <a href="articles/visualizations.html">Visualization of clustifyr results</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rnabioco/clustifyr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="clustifyr-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#clustifyr-" class="anchor"></a>clustifyr <img src="reference/figures/logo.png" align="right">
</h1></div>

<p>clustifyr classifies cells and clusters in single-cell RNA sequencing experiments using reference bulk RNA-seq data sets, sorted microarray expression data, single-cell gene signatures, or marker genes.</p>
<p>Single cell transcriptomes are difficult to annotate without extensive knowledge of the underlying biology of the system in question. Even with this knowledge, accurate identification can be challenging due to the lack of detectable expression of common marker genes. clustifyr solves this problem by automatically annotating single cells or clusters using scRNA-seq, bulk RNA-seq data, microarray or marker gene lists. Additional functions allow for exploratory analysis of similarities between single cell RNA-seq datasets and reference data.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># install.packages("devtools")</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"rnabioco/clustifyr"</span>)</span></code></pre></div>
</div>
<div id="example-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#example-usage" class="anchor"></a>Example usage</h2>
<p>In this example we use the following built-in input data:</p>
<ul>
<li>an expression matrix of single cell RNA-seq data (<code>pbmc_matrix_small</code>)</li>
<li>a metadata data.frame (<code>pbmc_meta</code>)</li>
<li>a vector of variable genes (<code>pbmc_vargenes</code>)-</li>
<li>a matrix of bulk RNA-seq read counts (<code>pbmc_bulk_matrix</code>):</li>
</ul>
<p>We then calculate correlation coefficients and plot them on a pre-calculated tSNE projection (stored in <code>pbmc_meta</code>).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(clustifyr)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(Seurat)</span>
<span id="cb2-3"><a href="#cb2-3"></a>res &lt;-<span class="st"> </span><span class="kw"><a href="reference/clustify.html">clustify</a></span>(</span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="dt">input =</span> pbmc_matrix_small,</span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="dt">metadata =</span> pbmc_meta<span class="op">$</span>classified,</span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="dt">ref_mat =</span> pbmc_bulk_matrix,</span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="dt">query_genes =</span> pbmc_vargenes</span>
<span id="cb2-8"><a href="#cb2-8"></a>)</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="kw"><a href="reference/plot_cor.html">plot_cor</a></span>(</span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="dt">cor_mat =</span> res,</span>
<span id="cb2-12"><a href="#cb2-12"></a>  <span class="dt">metadata =</span> pbmc_meta,</span>
<span id="cb2-13"><a href="#cb2-13"></a>  <span class="dt">data_to_plot =</span> <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(res)[<span class="dv">1</span>],</span>
<span id="cb2-14"><a href="#cb2-14"></a>  <span class="dt">cluster_col =</span> <span class="st">"classified"</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>)</span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="reference/figures/readme_example-1.png"><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw"><a href="reference/plot_best_call.html">plot_best_call</a></span>(</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="dt">cor_mat =</span> res, </span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="dt">metadata =</span> pbmc_meta, </span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="dt">cluster_col =</span> <span class="st">"classified"</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>)</span></code></pre></div>
<p><img src="reference/figures/readme_example-2.png"><!-- --></p>
<p>Alternatively, <code>clustify</code> can take a clustered <code>seurat</code> object (both v2 and v3) and assign identities. New reference matrix can be made directly from <code>seurat</code> object as well. Other scRNAseq experiment object types are supported as well.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>res &lt;-<span class="st"> </span><span class="kw"><a href="reference/clustify.html">clustify</a></span>(</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="dt">input =</span> s_small,</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="dt">cluster_col =</span> <span class="st">"res.1"</span>,</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="dt">ref_mat =</span> pbmc_bulk_matrix,</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="dt">seurat_out =</span> T,</span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="dt">dr =</span> <span class="st">"tsne"</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>)</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>res2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/clustify.html">clustify</a></span>(</span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="dt">input =</span> s_small3,</span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="dt">cluster_col =</span> <span class="st">"RNA_snn_res.1"</span>,</span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="dt">ref_mat =</span> pbmc_bulk_matrix,</span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="dt">seurat_out =</span> T,</span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="dt">dr =</span> <span class="st">"tsne"</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>)</span>
<span id="cb4-16"><a href="#cb4-16"></a></span>
<span id="cb4-17"><a href="#cb4-17"></a>res2</span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt; An object of class Seurat </span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co">#&gt; 230 features across 80 samples within 1 assay </span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co">#&gt; Active assay: RNA (230 features)</span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">#&gt;  2 dimensional reductions calculated: pca, tsne</span></span>
<span id="cb4-22"><a href="#cb4-22"></a></span>
<span id="cb4-23"><a href="#cb4-23"></a>new_ref_matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/seurat_ref.html">seurat_ref</a></span>(</span>
<span id="cb4-24"><a href="#cb4-24"></a>  <span class="dt">seurat_object =</span> s_small,</span>
<span id="cb4-25"><a href="#cb4-25"></a>  <span class="dt">cluster_col =</span> <span class="st">"res.1"</span>,</span>
<span id="cb4-26"><a href="#cb4-26"></a>  <span class="dt">var.genes_only =</span> <span class="ot">FALSE</span></span>
<span id="cb4-27"><a href="#cb4-27"></a>)</span>
<span id="cb4-28"><a href="#cb4-28"></a></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(new_ref_matrix)</span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="co">#&gt;                 0        1        2        3</span></span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="co">#&gt; MS4A1    4.517255 3.204766 0.000000 0.000000</span></span>
<span id="cb4-32"><a href="#cb4-32"></a><span class="co">#&gt; CD79B    4.504191 3.549095 2.580662 0.000000</span></span>
<span id="cb4-33"><a href="#cb4-33"></a><span class="co">#&gt; CD79A    4.457349 4.199849 0.000000 0.000000</span></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="co">#&gt; HLA-DRA  6.211779 6.430463 3.659590 4.169965</span></span>
<span id="cb4-35"><a href="#cb4-35"></a><span class="co">#&gt; TCL1A    4.394310 2.837922 0.000000 0.000000</span></span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="co">#&gt; HLA-DQB1 4.380289 4.325293 0.000000 1.666167</span></span></code></pre></div>
<p>Similarly, <code>clustify_lists</code> can also handle identity assignment of matrix or <code>seurat</code> object based on marker gene lists.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>res &lt;-<span class="st"> </span><span class="kw"><a href="reference/clustify_lists.html">clustify_lists</a></span>(</span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="dt">input =</span> pbmc_matrix_small,</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="dt">per_cell =</span> <span class="ot">FALSE</span>,</span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="dt">metadata =</span> pbmc_meta,</span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="dt">cluster_col =</span> <span class="st">"classified"</span>,</span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="dt">marker =</span> pbmc_markers,</span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="dt">marker_inmatrix =</span> <span class="ot">FALSE</span>,</span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="dt">metric =</span> <span class="st">"hyper"</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>)</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a>res &lt;-<span class="st"> </span><span class="kw"><a href="reference/clustify_lists.html">clustify_lists</a></span>(</span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="dt">input =</span> s_small,</span>
<span id="cb5-13"><a href="#cb5-13"></a>  <span class="dt">per_cell =</span> <span class="ot">FALSE</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="dt">marker =</span> pbmc_markers,</span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="dt">marker_inmatrix =</span> <span class="ot">FALSE</span>,</span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="dt">cluster_col =</span> <span class="st">"res.1"</span>,</span>
<span id="cb5-17"><a href="#cb5-17"></a>  <span class="dt">seurat_out =</span> <span class="ot">TRUE</span>,</span>
<span id="cb5-18"><a href="#cb5-18"></a>  <span class="dt">dr =</span> <span class="st">"tsne"</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>)</span></code></pre></div>
</div>
<div id="additional-reference-data" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-reference-data" class="anchor"></a>Additional reference data</h2>
<p>More reference data (including tabula muris, immgen, etc) are available at <a href="https://github.com/rnabioco/clustifyrdata" class="uri">https://github.com/rnabioco/clustifyrdata</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/rnabioco/clustifyr">https://â€‹github.com/â€‹rnabioco/â€‹clustifyr</a>
</li>
<li>Report a bug at <br><a href="https://github.com/rnabioco/clustifyr/issues">https://â€‹github.com/â€‹rnabioco/â€‹clustifyr/â€‹issues</a>
</li>
<li>External data sets at <br><a href="http://github.com/rnabioco/clustifyrdata">http://â€‹github.com/â€‹rnabioco/â€‹clustifyrdata</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Rui Fu <br><small class="roles"> Author, maintainer </small>  </li>
<li>Kent Riemondy <br><small class="roles"> Author </small>  </li>
<li>Austin Gillen <br><small class="roles"> Author </small>  </li>
<li>Chengzhe Tian <br><small class="roles"> Author </small>  </li>
<li>Jay Hesselberth <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/rnabioco/clustifyr"><img src="https://travis-ci.org/rnabioco/clustifyr.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/rnabioco/clustifyr"><img src="https://ci.appveyor.com/api/projects/status/github/rnabioco/clustifyr?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
<li><a href="https://codecov.io/github/rnabioco/clustifyr?branch=master"><img src="https://codecov.io/gh/rnabioco/clustifyr/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Rui Fu, Kent Riemondy, Austin Gillen, Chengzhe Tian, Jay Hesselberth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
